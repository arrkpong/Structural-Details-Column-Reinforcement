<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Structural Column Schedule (Full Version)</title>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ==========================================
           CSS Styling for Column Schedule
           ==========================================
           โครงสร้างหลัก:
           - body: พื้นหลังหน้าเว็บ
           - schedule-container: กล่องคลุมหลัก (พื้นขาว)
           - floor-zone: กล่องคลุมแต่ละโซนชั้น
           - drawing-row: แถวที่ใส่ Story Box + Column Boxes
           - box: กรอบ SVG พื้นฐาน
           - story-box: กล่องแสดงระดับชั้น
           - column-box: กล่องแสดงรายละเอียดเสา
           ========================================== */

        /* ---------- 0. CSS Variables ---------- */
        :root {
            --primary-color: #2563eb;
            --primary-dark: #1d4ed8;
            --accent-color: #0ea5e9;
            --bg-gradient-start: #f0f4f8;
            --bg-gradient-end: #e2e8f0;
            --card-bg: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 16px;
        }

        /* ---------- 1. Body & Global ---------- */
        body { 
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            padding: 24px; 
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.5;
        }

        /* ---------- 2. Header (H1) ---------- */
        h1 { 
            text-align: center; 
            color: var(--text-primary);
            font-weight: 700;
            font-size: 28px;
            margin-bottom: 32px;
            letter-spacing: -0.025em;
        }

        /* ---------- 3. Main Container ---------- */
        .schedule-container {
            max-width: 100%;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
        }

        /* ---------- 4. Floor Zone ---------- */
        .floor-zone {
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .zone-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 16px;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            padding: 12px 16px;
            border-left: 4px solid var(--primary-color);
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ---------- 5. Drawing Row ---------- */
        .drawing-row {
            display: flex;
            gap: 0;
            overflow-x: auto;
            padding-bottom: 12px;
            align-items: flex-start;
            transform-origin: top left;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--border-color);
        }

        .drawing-row::-webkit-scrollbar {
            height: 8px;
        }

        .drawing-row::-webkit-scrollbar-track {
            background: var(--border-color);
            border-radius: 4px;
        }

        .drawing-row::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        /* ---------- 6. Box ---------- */
        .box {
            border: 1px solid #334155;
            background: #fff;
            flex-shrink: 0;
        }

        /* ---------- 7. Story Box ---------- */
        .story-box {
            border: 2px solid var(--primary-dark);
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            position: sticky;
            left: 0;
            z-index: 10;
        }

        /* ---------- 9. Zoom Controls ---------- */
        .zoom-controls {
            position: fixed;
            bottom: 24px;
            right: 24px;
            display: flex;
            gap: 8px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            padding: 12px 16px;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
        }

        .zoom-controls button {
            padding: 10px 14px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--card-bg);
            color: var(--text-primary);
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .zoom-controls button:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .zoom-controls button:active {
            transform: translateY(0);
        }

        .zoom-controls span {
            display: flex;
            align-items: center;
            font-weight: 600;
            min-width: 54px;
            justify-content: center;
            color: var(--primary-color);
            font-size: 14px;
        }

        /* ----- 9.3 Tablet (768px - 1024px) ----- */
        @media screen and (max-width: 1024px) {
            body {
                padding: 10px;
            }
            
            h1 {
                font-size: 24px;
                margin-bottom: 20px;
            }
            
            .zone-title {
                font-size: 16px;
                padding: 8px;
            }
            
            .schedule-container {
                padding: 10px;
            }
        }

        /* ----- 9.4 Mobile (< 768px) ----- */
        @media screen and (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            h1 {
                font-size: 20px;
                margin-bottom: 15px;
            }
            
            .zone-title {
                font-size: 14px;
                padding: 6px;
                border-left-width: 3px;
            }
            
            .schedule-container {
                padding: 5px;
            }
            
            .drawing-row {
                gap: 0px;
            }
            
            /* ซ่อน Story Box บนมือถือเพื่อประหยัดพื้นที่ */
            .story-box {
                display: none;
            }
        }

        /* ----- 9.5 Print Styles ----- */
        @media print {
            .zoom-controls {
                display: none;
            }
            
            body {
                background: white;
                padding: 0;
            }
            
            .schedule-container {
                box-shadow: none;
            }
        }

    </style>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- SheetJS Library for Excel Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

    <div id="app" class="schedule-container">
        </div>

    <script>
        // ==========================================
        // 1. DATA STRUCTURE (ข้อมูลโครงสร้าง)
        // ==========================================
        /* เราแบ่งข้อมูลเป็น "ชั้นๆ" (Zones)
           ในแต่ละ Zone จะมี "เสา" (Columns) อยู่ข้างใน
        */
        const projectData = [
            // NOTE: C06, C17, C19 ไม่ปรากฏในตารางนี้ - อาจเป็น Shear Wall (SW)
            //  --- 30th Floor ---
            {
                zoneId: "L30-LF",
                title: "30th Floor to Roof",
                topLevel: "Roof (+90.00m)",
                bottomLevel: "30th Fl. (+87.00m)",
                columns: [
                    { name:"C01", isTerminated:true },
                    { name:"C02", isTerminated:true },
                    { name:"C03", isTerminated:true },
                    { name:"C04", isTerminated:true },
                    { name:"C05", isTerminated:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isTerminated:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", height:950, width:300, mainBar:"12-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isTerminated:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 29th Floor ---
            {
                zoneId: "L29-L30",
                title: "29th Floor to 30th Floor",
                topLevel: "30th Fl. (+87.00m)",
                bottomLevel: "29th Fl. (+84.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C02", height:1200, width:525, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"4-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:500, mainBar:"16-DB28@200", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:900, width:500, mainBar:"14-DB25", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", isTerminated:true },
                    { name:"C07", height:950, width:350, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"2-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isTerminated:true },
                    { name:"C11", height:950, width:300, mainBar:"12-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C12", height:950, width:350, mainBar:"16-DB20+16-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:1500, width:300, mainBar:"12-DB20+6-DB20", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", height:2000, width:250, mainBar:"16-DB20", confinementBar:"1-HP-DB10@175", tieBar:"8-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isTerminated:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },
            // --- 28th Floor ---
            {
                zoneId: "L28-L29",
                title: "28th Floor to 29th Floor",
                topLevel: "29th Fl. (+84.00m)",
                bottomLevel: "28th Fl. (+81.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", height:900, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@150", tieBar:"2-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C07", height:950, width:350, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"2-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", height:950, width:300, mainBar:"12-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isTerminated:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },
            // --- 27th Floor ---
            {
                zoneId: "L27-L28",
                title: "27th Floor to 28th Floor",
                topLevel: "28th Fl. (+81.00m)",
                bottomLevel: "27th Fl. (+78.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", height:1500, width:300, mainBar:"12-DB20+6-DB20", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C12", isSchematic:true },
                    { name:"C13", height:1500, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },
            // --- 26th Floor ---
            {
                zoneId: "L26-L27",
                title: "26th Floor to 27th Floor",
                topLevel: "27th Fl. (+78.00m)",
                bottomLevel: "26th Fl. (+75.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", height:2150, width:300, mainBar:"18-DB20+6-DB20", confinementBar:"1-HP-DB12@225", tieBar:"9-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", height:1500, width:300, mainBar:"12-DB25", confinementBar:"1-HP-DB12@225", tieBar:"4-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 25th Floor ---
            {
                zoneId: "L25-L26",
                title: "25th Floor to 26th Floor",
                topLevel: "26th Fl. (+75.00m)",
                bottomLevel: "25th Fl. (+72.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", height:2220, width:250, mainBar:"18-DB20+4-DB25", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 24th Floor ---
            {
                zoneId: "L24-L25",
                title: "24th Floor to 25th Floor",
                topLevel: "25th Fl. (+72.00m)",
                bottomLevel: "24th Fl. (+69.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isTerminated:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isSchematic:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 23rd Floor ---
            {
                zoneId: "L23-L24",
                title: "23rd Floor to 24th Floor",
                topLevel: "24th Fl. (+69.00m)",
                bottomLevel: "23rd Fl. (+66.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C02", height:1200, width:525, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"4-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:900, width:750, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB28", confinementBar:"1-HP-DB12@200", tieBar:"9-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C07", height:2150, width:350, mainBar:"18-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1100, width:450, mainBar:"12-DB25", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C11", height:2875, width:300, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C12", height:2650, width:250, mainBar:"16-DB20+16-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:300, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", height:2000, width:250, mainBar:"16-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", height:2875, width:375, mainBar:"16-DB25", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C16", isTerminated:true },
                    { name:"C18", height:2875, width:300, mainBar:"18-DB20+4-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", height:2220, width:250, mainBar:"18-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },

                    { name:"C27", height:2950, width:250, mainBar:"24-DB25", confinementBar:"1-HP-DB10@175", tieBar:"10-RB9@350", extra:"N/A", cover:"40mm" },
                    

                ]
            },

            // --- 22nd Floor ---
            {
                zoneId: "L22-L23",
                title: "22nd Floor to 23rd Floor",
                topLevel: "23rd Fl. (+66.00m)",
                bottomLevel: "22nd Fl. (+63.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", height:2150, width:350, mainBar:"20-DB25", confinementBar:"1-HP-DB12@250", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isSchematic:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 21st Floor ---
            {
                zoneId: "L21-L22",
                title: "21st Floor to 22nd Floor",
                topLevel: "22nd Fl. (+63.00m)",
                bottomLevel: "21st Fl. (+60.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isSchematic:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 20th Floor ---
            {
                zoneId: "L20-L21",
                title: "20th Floor to 21st Floor",
                topLevel: "21st Fl. (+60.00m)",
                bottomLevel: "20th Fl. (+57.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isTerminated:true },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isSchematic:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 19th Floor ---
            {
                zoneId: "L19-L20",
                title: "19th Floor to 20th Floor",
                topLevel: "20th Fl. (+57.00m)",
                bottomLevel: "19th Fl. (+54.00m)",
                columns: [
                    { name:"C01", isTerminated:true },
                    { name:"C02", isTerminated:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", height:2875, width:300, mainBar:"18-DB20+4-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C21", isTerminated:true },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isSchematic:true },

                    { name:"C27", isSchematic:true },
                    

                ]
            },

            // --- 18th Floor ---
            {
                zoneId: "L18-L19",
                title: "18th Floor to 19th Floor",
                topLevel: "19th Fl. (+54.00m)",
                bottomLevel: "18th Fl. (+51.00m)",
                columns: [
                    { name:"C01", isTerminated:true },
                    { name:"C02", isTerminated:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", height:2220, width:250, mainBar:"18-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },

                    { name:"C27", height:2950, width:250, mainBar:"24-DB25", confinementBar:"1-HP-DB10@175", tieBar:"10-RB9@350", extra:"N/A", cover:"40mm" },
                    

                ]
            },

            // --- 17th Floor ---
            {
                zoneId: "L17-L18",
                title: "17th Floor to 18th Floor",
                topLevel: "18th Fl. (+51.00m)",
                bottomLevel: "17th Fl. (+48.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C02", height:1200, width:525, mainBar:"18-DB25", confinementBar:"2-HP-DB12@200", tieBar:"4-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:900, width:750, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@200", tieBar:"9-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C07", height:2150, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@200", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1100, width:450, mainBar:"12-DB25", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C11", height:2875, width:300, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C12", height:2650, width:250, mainBar:"16-DB20+16-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:300, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", height:2000, width:250, mainBar:"16-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", height:2875, width:300, mainBar:"16-DB25", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C16", isTerminated:true },
                    { name:"C18", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", isTerminated:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 16th Floor ---
            {
                zoneId: "L16-L17",
                title: "16th Floor to 17th Floor",
                topLevel: "17th Fl. (+48.00m)",
                bottomLevel: "16th Fl. (+45.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 15Bth Floor ---
            {
                zoneId: "L15B-L16",
                title: "15Bth Floor to 16th Floor",
                topLevel: "16th Fl. (+45.00m)",
                bottomLevel: "15B Fl. (+42.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 15Ath Floor ---
            {
                zoneId: "L15A-L15B",
                title: "15Ath Floor to 15Bth Floor",
                topLevel: "15B Fl. (+42.00m)",
                bottomLevel: "15A Fl. (+39.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", height:1200, width:525, mainBar:"18-DB25", confinementBar:"2-HP-DB12@200", tieBar:"4-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1100, width:450, mainBar:"12-DB25", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 14th Floor ---
            {
                zoneId: "L14-L15A",
                title: "14th Floor to 15Ath Floor",
                topLevel: "15A Fl. (+39.00m)",
                bottomLevel: "14th Fl. (+36.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isTerminated:true },
                    { name:"C24", isTerminated:true },
                    { name:"C25", isTerminated:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },
            
            // --- 12th Floor ---
            {
                zoneId: "L12-L14",
                title: "12th Floor to 14th Floor",
                topLevel: "14th Fl. (+36.00m)",
                bottomLevel: "12th Fl. (+33.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@200", tieBar:"7-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25+8-DB20", confinementBar:"1-HP-DB12@175", tieBar:"3-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"18-DB20+6-DB25", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20+8-DB25", confinementBar:"1-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 11th Floor ---
            {
                zoneId: "L11-L12",
                title: "11th Floor to 12th Floor",
                topLevel: "12th Fl. (+33.00m)",
                bottomLevel: "11th Fl. (+30.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@150", tieBar:"4-RB9@300", extra:"3 H-150x150", cover:"40mm" },
                    { name:"C02", height:1200, width:750, mainBar:"14-DB32", confinementBar:"2-HP-DB12@200", tieBar:"3-DB12@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:900, width:750, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@200", tieBar:"9-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C07", height:2150, width:400, mainBar:"24-DB25+4-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-DB12@300", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1600, width:450, mainBar:"16-DB25", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C11", height:2875, width:300, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C12", height:2650, width:250, mainBar:"16-DB20+16-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:450, mainBar:"28-DB20", confinementBar:"1-HP-DB12@225", tieBar:"12-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", height:2000, width:250, mainBar:"16-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", height:2875, width:300, mainBar:"16-DB25", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C16", isTerminated:true },
                    { name:"C18", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", height:2400, width:400, mainBar:"20-DB25", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@175", tieBar:"3-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"20-DB20", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20", confinementBar:"1-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 10th Floor ---
            {
                zoneId: "L10-L11",
                title: "10th Floor to 11th Floor",
                topLevel: "11th Fl. (+30.00m)",
                bottomLevel: "10th Fl. (+27.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 9th Floor ---
            {
                zoneId: "L9-L10",
                title: "9th Floor to 10th Floor",
                topLevel: "10th Fl. (+27.00m)",
                bottomLevel: "9th Fl. (+24.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", height:2150, width:400, mainBar:"24-DB25+4-DB25", confinementBar:"1-HP-DB12@200", tieBar:"7-RB9@200", extra:"N/A", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 8th Floor ---
            {
                zoneId: "L8-L9",
                title: "8th Floor to 9th Floor",
                topLevel: "9th Fl. (+24.00m)",
                bottomLevel: "8th Fl. (+21.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@200", tieBar:"7-RB9@200", extra:"4 WF-100x100", cover:"40mm" },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },
            // --- 7th Floor ---
            {
                zoneId: "L7-L8",
                title: "7th Floor to 8th Floor",
                topLevel: "8th Fl. (+21.00m)",
                bottomLevel: "7th Fl. (+18.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 6th Floor ---
            {
                zoneId: "L6-L7",
                title: "6th Floor to 7th Floor",
                topLevel: "7th Fl. (+18.00m)",
                bottomLevel: "6th Fl. (+15.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@200", tieBar:"7-RB9@200", extra:"4 WF-100x100", cover:"40mm" },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1600, width:450, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"5-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C11", height:2875, width:300, mainBar:"46-DB20", confinementBar:"1-HP-DB12@225", tieBar:"9-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C12", isSchematic:true },
                    { name:"C13", height:2875, width:300, mainBar:"30-DB20", confinementBar:"1-HP-DB12@225", tieBar:"11-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C14", height:2000, width:250, mainBar:"16-DB20", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isTerminated:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },
            // --- 5th Floor ---
            {
                zoneId: "L5-L6",
                title: "5th Floor to 6th Floor",
                topLevel: "6th Fl. (+15.00m)",
                bottomLevel: "5th Fl. (+12.00m)",
                columns: [
                    { name:"C01", height:1650, width:250, mainBar:"12-DB25+6-DB20", confinementBar:"1-HP-DB10@150", tieBar:"4-RB9@300", extra:"3 H-150x150", cover:"40mm" },
                    { name:"C02", height:1200, width:750, mainBar:"14-DB32", confinementBar:"2-HP-DB12@200", tieBar:"3-DB12@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:900, width:750, mainBar:"16-DB25", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", height:2100, width:350, mainBar:"24-DB25", confinementBar:"1-HP-DB12@200", tieBar:"7-RB9@200", extra:"4 WF-150x150", cover:"40mm" },
                    { name:"C07", height:2150, width:400, mainBar:"20-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-DB12@300", extra:"4 WF-150x150", cover:"40mm" },

                    { name:"C08", isTerminated:true },
                    { name:"C09", isTerminated:true },
                    { name:"C10", height:1600, width:450, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"5-RB9@300", extra:"2 WF-150x150", cover:"40mm" },
                    { name:"C11", height:2875, width:300, mainBar:"46-DB20", confinementBar:"1-HP-DB12@225", tieBar:"9-DB9@225", extra:"3 WF-100x100", cover:"40mm" },
                    { name:"C12", height:2650, width:250, mainBar:"16-DB20+16-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:300, mainBar:"30-DB20", confinementBar:"1-HP-DB12@225", tieBar:"11-RB9@225", extra:"3 WF-100x100", cover:"40mm" },

                    { name:"C14", height:2650, width:250, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB10@175", tieBar:"6-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C14A", isTerminated:true},
                    { name:"C15", height:2875, width:300, mainBar:"16-DB25", confinementBar:"1-HP-DB12@225", tieBar:"6-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C16", isTerminated:true},
                    { name:"C18", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:300, mainBar:"18-DB20", confinementBar:"1-HP-DB12@225", tieBar:"7-RB9@225", extra:"N/A", cover:"40mm" },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", height:2400, width:400, mainBar:"20-DB25", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@175", tieBar:"3-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"20-DB20", confinementBar:"1-HP-DB12@175", tieBar:"7-RB9@350", extra:"3 H-150x150", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20", confinementBar:"1-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 4th Floor ---
            {
                zoneId: "L4-L5",
                title: "4th Floor to 5th Floor",
                topLevel: "5th Fl. (+12.00m)",
                bottomLevel: "4th Fl. (+9.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isSchematic:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isSchematic:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },


                ]
            },

            // --- 3rd Floor ---
            {
                zoneId: "L3-L4",
                title: "3rd Floor to 4th Floor",
                topLevel: "4th Fl. (+9.00m)",
                bottomLevel: "3rd Fl. (+6.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isSchematic:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isSchematic:true },
                    { name:"C18", isSchematic:true },
                    { name:"C20", isSchematic:true },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    

                ]
            },

            // --- 2nd Floor ---
            {
                zoneId: "L2-L3",
                title: "2nd Floor to 3rd Floor",
                topLevel: "3rd Fl. (+6.00m)",
                bottomLevel: "2nd Fl. (+3.00m)",
                columns: [
                    { name:"C01", height:2000, width:250, mainBar:"22-DB25", confinementBar:"1-HP-DB10@150", tieBar:"8-RB9@300", extra:"3 WF-100x100", cover:"40mm" },
                    { name:"C02", height:1200, width:750, mainBar:"14-DB32", confinementBar:"2-HP-DB12@200", tieBar:"3-RB12@200", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:1200, width:750, mainBar:"18-DB25", confinementBar:"2-HP-DB12@200", tieBar:"5-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C05", height:2100, width:400, mainBar:"24-DB28", confinementBar:"1-HP-DB12@200", tieBar:"7-RB9@200", extra:"4 WF-150x150", cover:"40mm" },
                    { name:"C07", height:2500, width:450, mainBar:"20-DB25+4-DB25", confinementBar:"1-HP-DB12@200", tieBar:"7-RB12@200", extra:"4 WF-100x100", cover:"40mm" },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", height:2300, width:450, mainBar:"22-DB25", confinementBar:"1-HP-DB12@150", tieBar:"10-RB9@300", extra:"2 WF-150x150", cover:"40mm" },
                    { name:"C11", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"2 WF-100x100", cover:"40mm" },
                    { name:"C12", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@200", tieBar:"6-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"2 WF-100x100", cover:"40mm" },

                    { name:"C14", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@200", tieBar:"6-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C14A", height:1200, width:300, mainBar:"10-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C15", height:2875, width:375, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"6-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C16", height:2250, width:250, mainBar:"18-DB20", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C18", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:350, mainBar:"18-DB20", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    
                ]
            },

            // --- 1st Floor ---
            {
                zoneId: "L1-L2",
                title: "1st Floor to 2nd Floor",
                topLevel: "2nd Fl. (+3.00m)",
                bottomLevel: "1st Fl. (0.00m)",
                columns: [
                    { name:"C01", height:2000, width:250, mainBar:"22-DB25", confinementBar:"1-HP-DB10@150", tieBar:"8-RB9@300", extra:"3 WF-100x100", cover:"40mm" },
                    { name:"C02", height:1200, width:750, mainBar:"14-DB32", confinementBar:"2-HP-DB12@150", tieBar:"3-RB12@300", extra:"N/A", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@150", tieBar:"3-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C04", height:1200, width:750, mainBar:"18-DB25", confinementBar:"2-HP-DB12@150", tieBar:"5-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", height:2300, width:450, mainBar:"22-DB25", confinementBar:"1-HP-DB12@125", tieBar:"10-RB9@250", extra:"2 WF-150x150", cover:"40mm" },
                    { name:"C11", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@125", tieBar:"8-RB9@250", extra:"2 WF-100x100", cover:"40mm" },
                    { name:"C12", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@125", tieBar:"13-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@125", tieBar:"8-RB9@250", extra:"2 WF-100x100", cover:"40mm" },

                    { name:"C14", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@125", tieBar:"13-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C14A", height:1200, width:300, mainBar:"20-DB25", confinementBar:"1-HP-DB12@125", tieBar:"3-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C15", height:2875, width:375, mainBar:"16-DB25", confinementBar:"1-HP-DB12@125", tieBar:"6-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C16", height:2250, width:250, mainBar:"18-DB20", confinementBar:"1-HP-DB12@125", tieBar:"7-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C18", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@125", tieBar:"8-RB9@250", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@125", tieBar:"8-RB9@125", extra:"N/A", cover:"40mm" },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@175", tieBar:"4-RB9@350", extra:"N/A", cover:"40mm" },
                    { name:"C22", isSchematic:true },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@150", tieBar:"3-RB9@150", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@150", extra:"N/A", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@150", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },
                    
                ]
            },
            
            // --- Basement ---
            {
                zoneId: "LB-L1",
                title: "basement to 1st Floor",
                topLevel: "1st Fl. (0.00m)",
                bottomLevel: "Basement (-3.00m)",
                columns: [
                    { name:"C01", isSchematic:true },
                    { name:"C02", isSchematic:true },
                    { name:"C03", isSchematic:true },
                    { name:"C04", isSchematic:true },
                    { name:"C05", isSchematic:true },
                    { name:"C07", isSchematic:true },

                    { name:"C08", isSchematic:true },
                    { name:"C09", isSchematic:true },
                    { name:"C10", isSchematic:true },
                    { name:"C11", isSchematic:true },
                    { name:"C12", isSchematic:true },
                    { name:"C13", isSchematic:true },

                    { name:"C14", isSchematic:true },
                    { name:"C14A", isSchematic:true },
                    { name:"C15", isSchematic:true },
                    { name:"C16", isSchematic:true },
                    { name:"C18", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"N/A", cover:"40mm" },

                    { name:"C21", isSchematic:true },
                    { name:"C22", isSchematic:true },
                    { name:"C23", isSchematic:true },
                    { name:"C24", isSchematic:true },
                    { name:"C25", isSchematic:true },
                    { name:"C26", isTerminated:true },
                    
                    { name:"C27", isTerminated:true },

                ]
            },
            // --- Foundation ---
            {
                zoneId: "LF-LB",
                title: "Foundation to basement",
                topLevel: "Basement (-3.00m)",
                bottomLevel: "Foundation (-7.50m)",
                columns: [
                    { name:"C01", height:2000, width:250, mainBar:"22-DB25", confinementBar:"1-HP-DB10@200", tieBar:"8-RB9@200", extra:"3 WF-100x100", cover:"40mm" },
                    { name:"C02", height:1200, width:750, mainBar:"14-DB32", confinementBar:"2-HP-DB12@200", tieBar:"3-DB12@200", extra:"-", cover:"40mm" },
                    { name:"C03", height:900, width:750, mainBar:"14-DB28", confinementBar:"2-HP-DB12@200", tieBar:"3-DB9@200", extra:"-", cover:"40mm" },
                    { name:"C04", height:1200, width:750, mainBar:"18-DB25", confinementBar:"1-HP-DB12@150", tieBar:"5-RB9@300", extra:"-", cover:"40mm" },
                    { name:"C05", height:2100, width:400, mainBar:"24-DB28+4-DB28", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"4 WF-150x150", cover:"40mm" },
                    { name:"C07", height:2500, width:450, mainBar:"20-DB25+4-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-RB12@300", extra:"4 WF-150x150", cover:"40mm" },
                    
                    { name:"C08", height:1500, width:200, mainBar:"16-DB16", confinementBar:"1-HP-RB9@150", tieBar:"6-RB6@300", extra:"N/A", cover:"40mm" },
                    { name:"C09", height:1500, width:200, mainBar:"16-DB16", confinementBar:"1-HP-RB9@150", tieBar:"6-RB6@300", extra:"N/A", cover:"40mm" },
                    { name:"C10", height:2300, width:450, mainBar:"22-DB25", confinementBar:"1-HP-DB12@150", tieBar:"10-RB9@300", extra:"2 WF-150x150", cover:"40mm" },
                    { name:"C11", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"2 WF-100x100", cover:"40mm" },
                    { name:"C12", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@200", tieBar:"13-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C13", height:2875, width:400, mainBar:"22-DB20", confinementBar:"1-HP-DB12@150", tieBar:"8-RB9@300", extra:"2 WF-100x100", cover:"40mm" },

                    { name:"C14", height:2650, width:300, mainBar:"16-DB20+14-DB16", confinementBar:"1-HP-DB12@200", tieBar:"13-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C14A", height:1200, width:300, mainBar:"20-DB25", confinementBar:"1-HP-DB12@200", tieBar:"3-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C15", height:2875, width:375, mainBar:"16-DB25", confinementBar:"1-HP-DB12@150", tieBar:"6-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C16", height:2250, width:250, mainBar:"26-DB20", confinementBar:"1-HP-DB12@150", tieBar:"10-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C18", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@200", tieBar:"8-RB9@200", extra:"N/A", cover:"40mm" },
                    { name:"C20", height:2875, width:350, mainBar:"20-DB20", confinementBar:"1-HP-DB12@200", tieBar:"8-RB9@200", extra:"N/A", cover:"40mm" },

                    { name:"C21", height:1000, width:950, mainBar:"20-DB25", confinementBar:"2-HP-DB12@300", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C22", height:2400, width:400, mainBar:"20-DB25", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C23", height:1200, width:350, mainBar:"10-DB25", confinementBar:"1-HP-DB12@150", tieBar:"3-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C24", height:1450, width:400, mainBar:"20-DB20", confinementBar:"1-HP-DB12@150", tieBar:"7-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C25", height:1000, width:400, mainBar:"14-DB20", confinementBar:"1-HP-DB12@150", tieBar:"4-RB9@300", extra:"N/A", cover:"40mm" },
                    { name:"C26", isTerminated:true },

                    { name:"C27", isTerminated:true },

                ]
            }
        ];

        // ==========================================
        // 2. CONFIGURATION (ค่าคงที่สำหรับการวาด)
        // ==========================================
        const CONFIG = {
            startX: 150,     // จุดเริ่มวาด X (ค่าขั้นต่ำสำหรับ StoryBox & คำนวณกึ่งกลาง)
            startY: 150,     // จุดเริ่มวาด Y (เว้นที่ข้างบนให้ชื่อชั้น)
            dimOffset: 40,   // ระยะห่างเส้น Dimension จากเสา
            textPadding: 50, // ระยะห่างตัวหนังสือใต้เสา
            baseSvgHeight: 400, // ความสูงพื้นฐานของ SVG (ไม่รวมความสูงเสา)
            showSectionView: false // ปิดการแสดงผล SECTION A-A
        };


        // ==========================================
        // 3. FUNCTIONS (ฟังก์ชันวาด)
        // ==========================================

            // 3.0 ฟังก์ชันวาดเหล็กเสริมใน Elevation View
        function generateRebarElevation(col, startX, startY, uniqueId, isFoundation) {
            let rebarSVG = '';
            
            // ===== Parse ข้อมูลเหล็กจาก string =====
            // Main Bar: รองรับ "12-DB20" หรือ "24-DB28+4-DB28" (จับเฉพาะส่วนแรก + รวมส่วนหลัง + ถ้ามี)
            const mainBarMatch = col.mainBar.match(/(\d+)-DB(\d+)/);
            let mainBarCount = mainBarMatch ? parseInt(mainBarMatch[1]) : 8;
            const mainBarSize = mainBarMatch ? parseInt(mainBarMatch[2]) : 20;
            // รองรับ + notation: เช่น "24-DB28+4-DB28" -> รวมเป็น 28 เส้น
            const plusMatch = col.mainBar.match(/\+(\d+)-DB/);
            if (plusMatch) {
                mainBarCount += parseInt(plusMatch[1]);
            }
            
            // Tie/Stirrup: รองรับ "RB9@100", "3-DB12@200", "7-RB9@300" 
            // Regex ใหม่: จับ @spacing จากท้าย string
            const tieMatch = col.tieBar ? col.tieBar.match(/@(\d+)/) : null;
            const tieSpacing = tieMatch ? parseInt(tieMatch[1]) : 150;
            
            // Confinement Bar: รองรับ "1-HP-DB12@200", "2-HP-DB12@200"
            const confMatch = col.confinementBar ? col.confinementBar.match(/@(\d+)/) : null;
            const confSpacing = confMatch ? parseInt(confMatch[1]) : tieSpacing;
            
            // ===== COVER ระยะหุ้ม =====
            const cover = 15; // ใช้ค่าประมาณ 15px เพื่อความสวยงาม
            
            // ===== วาดเหล็กหลัก (Main Bars) - แนวตั้ง =====
            // สมมติว่าเหล็กหลักอยู่ที่ขอบใกล้ทั้ง 2 ด้าน
            const mainBarRadius = Math.max(mainBarSize / 4, 3); // ความหนาเส้นเหล็กหลัก
            
            // คำนวณจำนวนเหล็กต่อด้าน (สมมติแบ่งครึ่ง)
            const barsPerSide = Math.ceil(mainBarCount / 4); // เหล็กมุม + เหล็กกลาง
            
            // คำนวณความยาวเหล็ก
            // ถ้าเป็นเสา Foundation: ด้านล่างงอฉาก, ด้านบนยื่นต่อ (Dowels)
            // ถ้าเป็นเสาปกติ: ด้านล่างต่อจากชั้นก่อน, ด้านบนยื่นต่อ (Dowels)
            
            // Note: startY คือระดับพื้นชั้นบน (Top Level)
            // ดังนั้นเหล็กต้องยื่นทะลุ startY ขึ้นไป (ค่า Y ลดลง)
            const dowelLength = 40; // ความยาวเหล็กเสียบ (สมมติ)
            const topBarY = startY - dowelLength; 
            
            // เหล็กหลักด้านซ้าย
            const leftX = startX + cover;
            if (isFoundation) {
                // Foundation: งอล่าง, ยื่นบน
                rebarSVG += `<path d="M ${leftX} ${topBarY} L ${leftX} ${startY + col.height - cover} L ${leftX - 20} ${startY + col.height - cover}" 
                             stroke="#DC143C" stroke-width="${mainBarRadius}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`;
            } else {
                // Normal: ยื่นบน (เพื่อต่อชั้นถัดไป)
                // (จริงๆ ต้องมีด้านล่างด้วย แต่ใน Schedule มักวาดแค่เส้นตรงยาวๆ แทนการทาบ)
                rebarSVG += `<line x1="${leftX}" y1="${topBarY}" x2="${leftX}" y2="${startY + col.height - cover}" 
                             stroke="#DC143C" stroke-width="${mainBarRadius}" stroke-linecap="round"/>`;
            }
            
            // เหล็กหลักด้านขวา
            const rightX = startX + col.width - cover;
            if (isFoundation) {
                // Foundation: งอล่าง, ยื่นบน
                rebarSVG += `<path d="M ${rightX} ${topBarY} L ${rightX} ${startY + col.height - cover} L ${rightX + 20} ${startY + col.height - cover}" 
                             stroke="#DC143C" stroke-width="${mainBarRadius}" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`;
            } else {
                // Normal: ยื่นบน
                rebarSVG += `<line x1="${rightX}" y1="${topBarY}" x2="${rightX}" y2="${startY + col.height - cover}" 
                             stroke="#DC143C" stroke-width="${mainBarRadius}" stroke-linecap="round"/>`;
            }
            
            // เหล็กหลักตรงกลาง (ถ้ามีมากกว่า 4 เส้น)
            if (mainBarCount > 4) {
                const middleBarsCount = Math.min(Math.floor((mainBarCount - 4) / 2), 3);
                const spacing = (col.width - 2 * cover) / (middleBarsCount + 1);
                for (let i = 1; i <= middleBarsCount; i++) {
                    const x = startX + cover + spacing * i;
                    rebarSVG += `<line x1="${x}" y1="${topBarY}" x2="${x}" y2="${startY + col.height - cover}" 
                                 stroke="#DC143C" stroke-width="${mainBarRadius - 1}" stroke-linecap="round" stroke-dasharray="4,2"/>`;
                }
            }
            
            // ===== กำหนด Confinement Zone (ตาม ACI 318) =====
            // Lo = max(h/6, 450mm, max column dimension)
            // สำหรับการแสดงผล ใช้ประมาณ 25% ของความสูงเสา
            const confZoneHeight = Math.max(col.height * 0.25, col.width, 450); // ตาม ACI 318
            const confStrokeWidth = 2;
            const tieStrokeWidth = 2;
            
            // ===== วาดเหล็ก Confinement Zone (หัวเสา) - สีส้ม =====
            if (col.confinementBar) {
                const numConfTop = Math.max(Math.floor(confZoneHeight / confSpacing), 2);
                const confScaledSpacing = confZoneHeight / (numConfTop + 1);
                
                for (let i = 0; i <= numConfTop; i++) {
                    const confY = startY + cover + confScaledSpacing * i;
                    // เส้นปลอกแนวนอน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${confY}" x2="${startX + col.width - cover + 5}" y2="${confY}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                    // Tick mark ที่ปลายทั้ง 2 ด้าน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${confY - 4}" x2="${startX + cover - 5}" y2="${confY + 4}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                    rebarSVG += `<line x1="${startX + col.width - cover + 5}" y1="${confY - 4}" x2="${startX + col.width - cover + 5}" y2="${confY + 4}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                }
                
                // ===== วาดเหล็ก Confinement Zone (ท้ายเสา) - สีส้ม =====
                for (let i = 0; i <= numConfTop; i++) {
                    const confY = startY + col.height - cover - confScaledSpacing * i;
                    // เส้นปลอกแนวนอน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${confY}" x2="${startX + col.width - cover + 5}" y2="${confY}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                    // Tick mark ที่ปลายทั้ง 2 ด้าน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${confY - 4}" x2="${startX + cover - 5}" y2="${confY + 4}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                    rebarSVG += `<line x1="${startX + col.width - cover + 5}" y1="${confY - 4}" x2="${startX + col.width - cover + 5}" y2="${confY + 4}" 
                                 stroke="#8B008B" stroke-width="${confStrokeWidth}"/>`;
                }
            }
            
            // ===== วาดเหล็กปลอก Normal Zone (กลางเสา) - สีน้ำเงิน =====
            const normalZoneStart = startY + cover + confZoneHeight;
            const normalZoneEnd = startY + col.height - cover - confZoneHeight;
            const normalZoneHeight = normalZoneEnd - normalZoneStart;
            
            if (normalZoneHeight > 0) {
                const numTies = Math.max(Math.floor(normalZoneHeight / tieSpacing), 1);
                const scaledSpacing = normalZoneHeight / (numTies + 1);
                
                for (let i = 1; i <= numTies; i++) {
                    const tieY = normalZoneStart + scaledSpacing * i;
                    // เส้นปลอกแนวนอน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${tieY}" x2="${startX + col.width - cover + 5}" y2="${tieY}" 
                                 stroke="#4169E1" stroke-width="${tieStrokeWidth}"/>`;
                    // Tick mark ที่ปลายทั้ง 2 ด้าน
                    rebarSVG += `<line x1="${startX + cover - 5}" y1="${tieY - 4}" x2="${startX + cover - 5}" y2="${tieY + 4}" 
                                 stroke="#4169E1" stroke-width="${tieStrokeWidth}"/>`;
                    rebarSVG += `<line x1="${startX + col.width - cover + 5}" y1="${tieY - 4}" x2="${startX + col.width - cover + 5}" y2="${tieY + 4}" 
                                 stroke="#4169E1" stroke-width="${tieStrokeWidth}"/>`;
                }
            }
            
            // ===== เหล็กปลอกบนสุดและล่างสุด =====
            const topTieY = startY + cover;
            const bottomTieY = startY + col.height - cover;
            
            rebarSVG += `<line x1="${startX + cover - 5}" y1="${topTieY}" x2="${startX + col.width - cover + 5}" y2="${topTieY}" 
                         stroke="#4169E1" stroke-width="${tieStrokeWidth}"/>`;
            rebarSVG += `<line x1="${startX + cover - 5}" y1="${bottomTieY}" x2="${startX + col.width - cover + 5}" y2="${bottomTieY}" 
                         stroke="#4169E1" stroke-width="${tieStrokeWidth}"/>`;
            
            // ===== เพิ่ม Dimension Bar ด้านขวา (Rebar Spacing) =====
            const dimX = startX + col.width + 30; // ขยับออกมาทางขวา 30px
            const dimColor = "red"; // ใช้สีแดงตามเสา
            const dimFontSize = 18; // ขนาดฟอนต์ตามเสา
            
            // Note: ใช้ marker-start และ marker-end ที่มีอยู่แล้ว (uniqueId)
            
            // 1. Dimension - Confinement Top
            const confTopY = startY + cover + confZoneHeight;
            rebarSVG += `
                <g stroke="${dimColor}" stroke-width="2">
                    <!-- เส้นบอกระยะ -->
                    <line x1="${dimX}" y1="${startY}" x2="${dimX}" y2="${confTopY}" marker-start="url(#${uniqueId})" marker-end="url(#${uniqueId})" />
                    <!-- เส้น Extension line แนวนอน -->
                    <line x1="${startX + col.width}" y1="${startY}" x2="${dimX + 10}" y2="${startY}" stroke-width="1" stroke-dasharray="4,2" />
                    <line x1="${startX + col.width}" y1="${confTopY}" x2="${dimX + 10}" y2="${confTopY}" stroke-width="1" stroke-dasharray="4,2" />
                    <!-- ข้อความ -->
                    <text x="${dimX + 15}" y="${startY + confZoneHeight/2}" fill="${dimColor}" font-size="${dimFontSize}" dominant-baseline="middle" text-anchor="start">
                        Conf. @${confSpacing}
                    </text>
                </g>
            `;
            
            // 2. Dimension - Normal Zone (Middle)
            const normalStart = confTopY;
            const normalEnd = startY + col.height - cover - confZoneHeight;
            
            // ป้องกันกรณีทับซ้อนถ้า Normal Zone เล็กมาก
            if (normalEnd > normalStart) {
                 rebarSVG += `
                    <g stroke="${dimColor}" stroke-width="2">
                        <line x1="${dimX}" y1="${normalStart}" x2="${dimX}" y2="${normalEnd}" marker-start="url(#${uniqueId})" marker-end="url(#${uniqueId})" />
                        <line x1="${startX + col.width}" y1="${normalEnd}" x2="${dimX + 10}" y2="${normalEnd}" stroke-width="1" stroke-dasharray="4,2" />
                        <text x="${dimX + 15}" y="${normalStart + (normalEnd-normalStart)/2}" fill="${dimColor}" font-size="${dimFontSize}" dominant-baseline="middle" text-anchor="start">
                            Tie @${tieSpacing}
                        </text>
                    </g>
                `;
            }

            // 3. Dimension - Confinement Bottom
            const confBotStart = normalEnd;
            const confBotEnd = startY + col.height;
            rebarSVG += `
                <g stroke="${dimColor}" stroke-width="2">
                    <line x1="${dimX}" y1="${confBotStart}" x2="${dimX}" y2="${confBotEnd}" marker-start="url(#${uniqueId})" marker-end="url(#${uniqueId})" />
                    <line x1="${startX + col.width}" y1="${confBotEnd}" x2="${dimX + 10}" y2="${confBotEnd}" stroke-width="1" stroke-dasharray="4,2" />
                    <text x="${dimX + 15}" y="${confBotStart + (confBotEnd-confBotStart)/2}" fill="${dimColor}" font-size="${dimFontSize}" dominant-baseline="middle" text-anchor="start">
                        Conf. @${confSpacing}
                    </text>
                </g>
            `;

            return rebarSVG;
        }

        // 3.0.1 ฟังก์ชันวาด Section View (รูปตัดขวาง)
        function generateSectionView(col, startX, startY) {
            let sectionSVG = '';
            const cover = 40; // Cover จริง 40mm (Scale 1px=1mm ไปเลยเพื่อง่าย)
            
            // 1. วาด Concrete Outline (ใช้วงกลมนิดๆ ให้ดูมนสมจริงงานเขียนแบบ)
            sectionSVG += `<rect x="${startX}" y="${startY}" width="${col.width}" height="${col.width}" 
                           fill="#f0f0f0" stroke="black" stroke-width="4" rx="5" ry="5"/>`;

            // 2. วาด Stirrup (เหล็กปลอก) - Outline ด้านใน
            const tieX = startX + cover;
            const tieY = startY + cover;
            const tieSize = col.width - (2 * cover);
            
            // ปลอกเดี่ยว (Single Tie)
            sectionSVG += `<rect x="${tieX}" y="${tieY}" width="${tieSize}" height="${tieSize}" 
                           fill="none" stroke="#4169E1" stroke-width="3" rx="5" ry="5"/>`;
                           
            // Hook ของปลอก (135 องศา - แบบง่าย)
            sectionSVG += `<path d="M ${tieX + 10} ${tieY + 10} L ${tieX - 5} ${tieY - 5}" stroke="#4169E1" stroke-width="3"/>`;
            sectionSVG += `<path d="M ${tieX + 10} ${tieY + 20} L ${tieX + 20} ${tieY + 10}" stroke="#4169E1" stroke-width="3"/>`;

            // 3. วาด Main Bars (จุดวงกลม)
            // Parse ข้อมูล
            const mainBarMatch = col.mainBar.match(/(\d+)-DB(\d+)/);
            const numBars = mainBarMatch ? parseInt(mainBarMatch[1]) : 8;
            const barSize = mainBarMatch ? parseInt(mainBarMatch[2]) : 20;
            const barRadius = Math.max(barSize / 2, 4); // รัศมีวงกลมเหล็กในรูปตัด
            
            // คำนวณตำแหน่งเหล็ก
            // 4 มุมเสมอ
            const corners = [
                {x: tieX, y: tieY}, // Top-Left
                {x: tieX + tieSize, y: tieY}, // Top-Right
                {x: tieX + tieSize, y: tieY + tieSize}, // Bottom-Right
                {x: tieX, y: tieY + tieSize} // Bottom-Left
            ];
            
            // วาดเหล็กมุม 4 เส้น
            corners.forEach(p => {
                sectionSVG += `<circle cx="${p.x}" cy="${p.y}" r="${barRadius}" fill="#DC143C" stroke="black" stroke-width="1"/>`;
            });
            
            // เหล็กข้าง (Side bars)
            if (numBars > 4) {
                const remainingBars = numBars - 4;
                const barsPerSide = remainingBars / 4; // สมมติกระจายเท่ากัน 4 ด้าน (เบื้องต้น)
                // ตรวจสอบว่าหารลงตัวไหม ถ้าไม่ลงอาจจะต้อง logic ซับซ้อนกว่านี้ (เอาแบบง่ายก่อนนะ)
                const perSideInt = Math.ceil(barsPerSide); 
                
                // ระยะห่างระหว่างเหล็กแกน
                const spacing = tieSize / (perSideInt + 1);
                
                // Top & Bottom Sides
                for(let i=1; i<=perSideInt; i++) {
                     // Top
                     sectionSVG += `<circle cx="${tieX + spacing*i}" cy="${tieY}" r="${barRadius}" fill="#DC143C" stroke="black" stroke-width="1"/>`;
                     // Bottom
                     sectionSVG += `<circle cx="${tieX + spacing*i}" cy="${tieY + tieSize}" r="${barRadius}" fill="#DC143C" stroke="black" stroke-width="1"/>`;
                     // Left
                     sectionSVG += `<circle cx="${tieX}" cy="${tieY + spacing*i}" r="${barRadius}" fill="#DC143C" stroke="black" stroke-width="1"/>`;
                     // Right
                     sectionSVG += `<circle cx="${tieX + tieSize}" cy="${tieY + spacing*i}" r="${barRadius}" fill="#DC143C" stroke="black" stroke-width="1"/>`;
                }
            }
            
            // 4. ข้อความ SECTION A-A
            sectionSVG += `<text x="${startX + col.width/2}" y="${startY + col.width + 50}" 
                           font-size="24" fill="black" font-weight="bold" text-anchor="middle" text-decoration="underline">SECTION A-A</text>`;

            // 5. Dimension รอบรูปตัด (Dimensions for Section View)
            const dimOffset = 30;
            const tickSize = 5; // ความยาวเส้นขีดมิติ
            const dimColor = "red";
            
            // 5.1 Horizontal Dimension (Top)
            const dimY_top = startY - dimOffset;
            sectionSVG += `
                <g stroke="${dimColor}" stroke-width="1">
                    <line x1="${startX}" y1="${dimY_top}" x2="${startX + col.width}" y2="${dimY_top}" marker-start="url(#tick-dim)" marker-end="url(#tick-dim)"/>
                    <line x1="${startX}" y1="${startY}" x2="${startX}" y2="${dimY_top - tickSize}" />
                    <line x1="${startX + col.width}" y1="${startY}" x2="${startX + col.width}" y2="${dimY_top - tickSize}" />
                    <text x="${startX + col.width/2}" y="${dimY_top - 8}" fill="${dimColor}" font-size="16" text-anchor="middle">${col.width}</text>
                </g>
            `;
            
            // 5.2 Vertical Dimension (Left)
            const dimX_left = startX - dimOffset;
            sectionSVG += `
                <g stroke="${dimColor}" stroke-width="1">
                    <line x1="${dimX_left}" y1="${startY}" x2="${dimX_left}" y2="${startY + col.width}" marker-start="url(#tick-dim)" marker-end="url(#tick-dim)"/>
                    <line x1="${startX}" y1="${startY}" x2="${dimX_left - tickSize}" y2="${startY}" />
                    <line x1="${startX}" y1="${startY + col.width}" x2="${dimX_left - tickSize}" y2="${startY + col.width}" />
                    
                    <text x="${dimX_left - 8}" y="${startY + col.width/2}" fill="${dimColor}" font-size="16" text-anchor="middle" transform="rotate(-90, ${dimX_left - 8}, ${startY + col.width/2})">${col.width}</text>
                </g>
            `;

            return sectionSVG;
        }

        // 3.1 ฟังก์ชันสร้าง Story Box (บอกระดับชั้น)
        function generateStoryBox(topText, bottomText, height, viewHeight) {
            const { startY } = CONFIG;
            // ระยะห่างระหว่าง Text บน กับ Line บน = startY(150) - 50 = 100
            const spacing = startY - 50; 
            
            // Text ล่างอยู่ตำแหน่ง viewHeight - 50 (เผื่อขอบล่าง 50)
            const bottomTextY = viewHeight - 50;
            // Line ล่างจึงควรอยู่เหนือ Text ขึ้นมา 100 เท่ากัน
            const bottomLineY = bottomTextY - spacing;

            return `
                <div class="box story-box">
                    <svg width="250" height="${viewHeight}" xmlns="http://www.w3.org/2000/svg">
                        <text x="125" y="50" font-size="24" fill="blue" font-weight="bold" text-anchor="middle">${topText}</text>
                        <line x1="20" y1="${startY}" x2="230" y2="${startY}" stroke="blue" stroke-width="2" stroke-dasharray="10,5"/>

                        <text x="125" y="${bottomTextY}" font-size="24" fill="blue" font-weight="bold" text-anchor="middle">${bottomText}</text>
                        <line x1="20" y1="${bottomLineY}" x2="230" y2="${bottomLineY}" stroke="blue" stroke-width="2" stroke-dasharray="10,5"/>
                    </svg>
                </div>
            `;
        }

        // 3.2 ฟังก์ชันสร้าง Column Box (วาดเสา + Dimensions + Section)
        function generateColumnSVG(col, isFoundation = false, viewHeight, svgWidth) {
            const { dimOffset, textPadding } = CONFIG; // เอา startX และ startY ออกจาก CONFIG
            
            // คำนวณ startX ให้เสาอยู่ตรงกลาง Box (Center Align)
            // แต่ต้องไม่น้อยกว่า 150 (CONFIG.startX เดิม) เพื่อให้มีที่เหลือสำหรับ Dimension ด้านซ้าย
            const calculatedStartX = (svgWidth - col.width) / 2;
            const startX = Math.max(calculatedStartX, 150);
            
            // คำนวณ startY แบบ Bottom-Aligned
            // Content Height = dim(100) + elevation title(50) + col.height + labels(~160)
            // + section offset/view เฉพาะเมื่อเปิด Section
            const sectionHeight = CONFIG.showSectionView ? (220 + col.width + 100) : 0;
            const contentHeight = 100 + col.height + 160 + sectionHeight;
            const bottomMargin = 150; // เผื่อขอบล่าง (เพิ่มจาก 50)
            const topMargin = 100; // เผื่อขอบบน (สำหรับชื่อเสา + dimension)
            // startY = ตำแหน่งที่ทำให้ Content ชิดล่าง
            const startY = Math.max(viewHeight - contentHeight - bottomMargin + 100, topMargin);
            
            const uniqueId = `tick-${col.name}-${Math.floor(Math.random() * 1000)}`;
            
            // ===== CASE 1: เสาหยุด (Terminated) =====
            if (col.isTerminated) {
                 // ใช้ viewHeight/2 เป็นกึ่งกลางตายตัว เพื่อให้ทุกเสาอยู่ตำแหน่งเดียวกัน
                 const centerY = viewHeight / 2;
                 // ใช้ default width ถ้าไม่มีค่า
                 const rectWidth = col.width || 300;

                 return `
                    <div class="box column-box">
                        <svg width="${svgWidth}" height="${viewHeight}" xmlns="http://www.w3.org/2000/svg">
                            <!-- ชื่อเสา - ใช้ svgWidth/2 เพื่อให้อยู่กลาง Box จริงๆ -->
                            <text x="${svgWidth/2}" y="50" font-size="32" fill="red" font-weight="bold" text-anchor="middle">${col.name}</text>
                            
                            <!-- สัญลักษณ์เสาหยุด (Flat Rectangle) -->
                            <!-- วางไว้ตรงกลาง Box -->
                            <rect x="${svgWidth/2 - rectWidth/2}" y="${centerY - 10}" width="${rectWidth}" height="20" 
                                  fill="none" stroke="black" stroke-width="2"/>
                                  
                            <!-- Optional: Text บอกสถานะ -->
                             <text x="${svgWidth/2}" y="${centerY + 40}" font-size="16" fill="#666" text-anchor="middle">(Terminated)</text>
                        </svg>
                    </div>
                `;
            }

            // ===== CASE 2: เสาแบบย่อ (Schematic / Arrow) =====
            if (col.isSchematic) {
                 // ใช้ viewHeight/2 เป็นกึ่งกลางตายตัว เพื่อให้ทุกเสาอยู่ตำแหน่งเดียวกัน
                 const centerY = viewHeight / 2;
                 return `
                    <div class="box column-box">
                        <svg width="${svgWidth}" height="${viewHeight}" xmlns="http://www.w3.org/2000/svg">
                            <!-- ชื่อเสา -->
                            <text x="${svgWidth/2}" y="50" font-size="32" fill="red" font-weight="bold" text-anchor="middle">${col.name}</text>
                            
                            <!-- ลูกศรชี้ขึ้น (Arrow) -->
                            <!-- ใช้ viewHeight/2 เป็นกึ่งกลาง -->
                            <g transform="translate(${svgWidth/2}, ${centerY}) scale(2)">
                                <path d="M 0 -20 L 0 20 M -10 -10 L 0 -20 L 10 -10" 
                                      stroke="#333" stroke-width="2" fill="none" />
                            </g>
                            
                             <!-- Text บอกความหมาย -->
                             <text x="${svgWidth/2}" y="${centerY + 60}" font-size="16" fill="#666" text-anchor="middle">Typical</text>
                        </svg>
                    </div>
                `;
            }

            // ===== CASE 3: เสาปกติ (Normal) =====
            return `
                <div class="box column-box">
                    <svg width="${svgWidth}" height="${viewHeight}" xmlns="http://www.w3.org/2000/svg">
                        
                        <defs>
                            <marker id="${uniqueId}" markerWidth="12" markerHeight="12" refX="6" refY="6" orient="auto">
                                <line x1="2" y1="10" x2="10" y2="2" stroke="red" stroke-width="2" />
                            </marker>
                            <!-- Global Marker for Section Dimensions (ถ้ายังไม่มี) -->
                            <marker id="tick-dim" markerWidth="12" markerHeight="12" refX="6" refY="6" orient="auto">
                                <line x1="2" y1="10" x2="10" y2="2" stroke="red" stroke-width="2" />
                            </marker>
                        </defs>

                        <text x="${startX + col.width/2}" y="50" font-size="32" fill="red" font-weight="bold" text-anchor="middle">${col.name}</text>

                        <rect x="${startX}" y="${startY}" width="${col.width}" height="${col.height}" 
                              fill="none" stroke="black" stroke-width="4"/>

                        <!-- ====== REBAR IN ELEVATION VIEW ====== -->
                        ${generateRebarElevation(col, startX, startY, uniqueId, isFoundation)}

                        <g stroke="red" stroke-width="2">
                            <line x1="${startX}" y1="${startY}" x2="${startX}" y2="${startY - dimOffset - 15}" stroke-width="1"/>
                            <line x1="${startX + col.width}" y1="${startY}" x2="${startX + col.width}" y2="${startY - dimOffset - 15}" stroke-width="1"/>
                            <line x1="${startX}" y1="${startY - dimOffset}" x2="${startX + col.width}" y2="${startY - dimOffset}"
                                  marker-start="url(#${uniqueId})" marker-end="url(#${uniqueId})"/>
                            <text x="${startX + col.width/2}" y="${startY - dimOffset - 10}" font-size="18" fill="red" text-anchor="middle">${col.width}</text>
                        </g>

                        <g stroke="red" stroke-width="2">
                            <line x1="${startX}" y1="${startY}" x2="${startX - dimOffset - 15}" y2="${startY}" stroke-width="1"/>
                            <line x1="${startX}" y1="${startY + col.height}" x2="${startX - dimOffset - 15}" y2="${startY + col.height}" stroke-width="1"/>
                            <line x1="${startX - dimOffset}" y1="${startY}" x2="${startX - dimOffset}" y2="${startY + col.height}"
                                  marker-start="url(#${uniqueId})" marker-end="url(#${uniqueId})"/>
                            <text x="${startX - dimOffset - 15}" y="${startY + col.height/2}" font-size="18" fill="red" text-anchor="middle"
                                  transform="rotate(-90, ${startX - dimOffset - 15}, ${startY + col.height/2})">${col.height}</text>
                        </g>

                        <g font-size="18" fill="#333" font-family="monospace">
                            <text x="${startX}" y="${startY + col.height + textPadding}">MAIN : ${col.mainBar}</text>
                            <text x="${startX}" y="${startY + col.height + textPadding + 25}">CONFINEMENT BAR : ${col.confinementBar}</text>
                            <text x="${startX}" y="${startY + col.height + textPadding + 50}">TIE  : ${col.tieBar}</text>
                            <text x="${startX}" y="${startY + col.height + textPadding + 75}">EXTRA : ${col.extra}</text>
                            <text x="${startX}" y="${startY + col.height + textPadding + 100}">COVER : ${col.cover}</text>
                        </g>

                        <!-- View Title (Elevation) -->
                        <text x="${startX + col.width/2}" y="${startY + col.height + textPadding + 160}" 
                              font-size="24" fill="black" font-weight="bold" text-anchor="middle" text-decoration="underline">ELEVATION VIEW</text>

                         <!-- ====== SECTION VIEW ====== -->
                         <!-- วาด Section ต่อท้ายด้านล่าง -->
                         ${CONFIG.showSectionView ? generateSectionView(col, startX, startY + col.height + textPadding + 220) : ""}

                    </svg>
                </div>
            `;
        }

        // ==========================================
        // 4. MAIN EXECUTION (ประมวลผล)
        // ==========================================
        const appContainer = document.getElementById('app');
        let fullContentHTML = "";

        // ===== คำนวณความกว้างเสาสูงสุดจากทุก Zone (เพื่อให้ทุก Box มีความกว้างเท่ากัน) =====
        let globalMaxColumnWidth = 0;
        projectData.forEach(zone => {
            zone.columns.forEach(col => {
                if (col.width > globalMaxColumnWidth) globalMaxColumnWidth = col.width;
            });
        });
        const unifiedSvgWidth = Math.max(CONFIG.startX + globalMaxColumnWidth + 250, 600);

        // ===== คำนวณความสูงเสาสูงสุดทั้งโปรเจกต์ (ให้ทุกชั้นสูงเท่ากัน) =====
        let globalMaxColumnHeight = 0;
        let globalMaxSectionHeight = 0;
        projectData.forEach(zone => {
            zone.columns.forEach(c => {
                const h = c.height || 0;
                if (h > globalMaxColumnHeight) globalMaxColumnHeight = h;

                if (CONFIG.showSectionView && !c.isTerminated && !c.isSchematic && c.width) {
                    const currentSecH = c.width + 200; // เพิ่ม padding สำหรับ dimension และ label
                    if (currentSecH > globalMaxSectionHeight) globalMaxSectionHeight = currentSecH;
                }
            });
        });
        if (globalMaxColumnHeight === 0) globalMaxColumnHeight = 1500;
        const globalTotalViewHeight = Math.max(
            globalMaxColumnHeight + CONFIG.baseSvgHeight + globalMaxSectionHeight,
            600
        );

        // วนลูปทีละ "โซนชั้น" (Zone)
        projectData.forEach(zone => {
            
            // ใช้ความสูงรวมแบบคงที่ เพื่อให้ทุกชั้นสูงเท่ากัน
            const maxColumnHeight = globalMaxColumnHeight;
            const totalViewHeight = globalTotalViewHeight;

            // 4.2 สร้าง HTML ส่วนหัวของ Zone
            fullContentHTML += `
                <div class="floor-zone">
                    <div class="drawing-row">
            `;

            // 4.3 ใส่ Story Box (ซ้ายสุด)
            fullContentHTML += generateStoryBox(zone.topLevel, zone.bottomLevel, maxColumnHeight, totalViewHeight);

            // 4.4 วนลูปใส่เสา (Columns)
            zone.columns.forEach(col => {
                // เช็คว่าเป็น Zone Foundation หรือไม่ (LF-LB = Foundation to Basement)
                const isFoundation = (zone.zoneId === "LF-LB");
                fullContentHTML += generateColumnSVG(col, isFoundation, totalViewHeight, unifiedSvgWidth);
            });

            // ปิด Tag ของ Zone
            fullContentHTML += `
                    </div>
                </div>
            `;
        });

        // แสดงผลลัพธ์
        appContainer.innerHTML = fullContentHTML;

        // ==========================================
        // 5. ZOOM CONTROLS (ควบคุมการซูม)
        // ==========================================
        
        // เพิ่ม Zoom Controls ลงในหน้า
        const zoomControlsHTML = `
            <div class="zoom-controls">
                <button id="zoomOut"><i data-lucide="zoom-out"></i></button>
                <span id="zoomLevel">100%</span>
                <button id="zoomIn"><i data-lucide="zoom-in"></i></button>
                <button id="zoomReset"><i data-lucide="rotate-ccw"></i> Reset</button>
                <button id="exportExcel"><i data-lucide="file-spreadsheet"></i> Excel</button>
                <button id="exportSVG"><i data-lucide="image"></i> SVG</button>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', zoomControlsHTML);
        lucide.createIcons();
        
        // Zoom State
        let currentZoom = 1;
        const zoomStep = 0.1;
        const minZoom = 0.3;
        const maxZoom = 2;
        
        // Zoom Functions
        function updateZoom() {
            const drawingRows = document.querySelectorAll('.drawing-row');
            drawingRows.forEach(row => {
                row.style.transform = `scale(${currentZoom})`;
            });
            document.getElementById('zoomLevel').textContent = Math.round(currentZoom * 100) + '%';
        }
        
        document.getElementById('zoomIn').addEventListener('click', () => {
            if (currentZoom < maxZoom) {
                currentZoom = Math.min(currentZoom + zoomStep, maxZoom);
                updateZoom();
            }
        });
        
        document.getElementById('zoomOut').addEventListener('click', () => {
            if (currentZoom > minZoom) {
                currentZoom = Math.max(currentZoom - zoomStep, minZoom);
                updateZoom();
            }
        });
        
        document.getElementById('zoomReset').addEventListener('click', () => {
            currentZoom = 1;
            updateZoom();
        });
        
        // Keyboard shortcuts (Ctrl + / Ctrl -)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && (e.key === '=' || e.key === '+')) {
                e.preventDefault();
                document.getElementById('zoomIn').click();
            } else if (e.ctrlKey && e.key === '-') {
                e.preventDefault();
                document.getElementById('zoomOut').click();
            } else if (e.ctrlKey && e.key === '0') {
                e.preventDefault();
                document.getElementById('zoomReset').click();
            }
        });

        // ==========================================
        // 6. EXPORT TO EXCEL
        // ==========================================
        
        function exportToExcel() {
            // สร้าง Array สำหรับข้อมูล Excel
            const excelData = [];
            
            // Header Row
            excelData.push([
                'Zone',
                'Top Level',
                'Bottom Level',
                'Column Name',
                'Height (mm)',
                'Width (mm)',
                'Main Bar',
                'Confinement Bar',
                'Tie Bar',
                'Extra',
                'Cover',
                'Status'
            ]);
            
            // วนลูปผ่าน projectData
            projectData.forEach(zone => {
                zone.columns.forEach(col => {
                    let status = 'Full Detail';
                    if (col.isTerminated) status = 'Terminated';
                    else if (col.isSchematic) status = 'Schematic';
                    
                    excelData.push([
                        zone.title,
                        zone.topLevel,
                        zone.bottomLevel,
                        col.name,
                        col.height || '-',
                        col.width || '-',
                        col.mainBar || '-',
                        col.confinementBar || '-',
                        col.tieBar || '-',
                        col.extra || '-',
                        col.cover || '-',
                        status
                    ]);
                });
            });
            
            // สร้าง Workbook และ Worksheet
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            
            // ตั้งค่าความกว้างคอลัมน์
            ws['!cols'] = [
                { wch: 30 },  // Zone
                { wch: 20 },  // Top Level
                { wch: 20 },  // Bottom Level
                { wch: 12 },  // Column Name
                { wch: 12 },  // Height
                { wch: 10 },  // Width
                { wch: 20 },  // Main Bar
                { wch: 20 },  // Confinement Bar
                { wch: 15 },  // Tie Bar
                { wch: 15 },  // Extra
                { wch: 10 },  // Cover
                { wch: 12 }   // Status
            ];
            
            // เพิ่ม Worksheet ลงใน Workbook
            XLSX.utils.book_append_sheet(wb, ws, 'Column Schedule');
            
            // สร้างชื่อไฟล์พร้อมวันที่
            const today = new Date();
            const dateStr = today.toISOString().slice(0, 10);
            const filename = `Column_Schedule_Elevation_${dateStr}.xlsx`;
            
            // Download ไฟล์
            XLSX.writeFile(wb, filename);
            
            // แจ้งเตือนสำเร็จ
            alert(`ส่งออกไฟล์ ${filename} สำเร็จ!`);
        }
        
        // Event Listener สำหรับปุ่ม Export
        document.getElementById('exportExcel').addEventListener('click', exportToExcel);

        // ==========================================
        // 7. EXPORT TO SVG (รวมทุก Zone เป็น 1 ไฟล์)
        // ==========================================
        
        function exportToSVG() {
            // แจ้งเตือนว่ากำลังสร้างไฟล์
            const loadingMsg = document.createElement('div');
            loadingMsg.id = 'loadingMsg';
            loadingMsg.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#333;color:white;padding:30px 50px;border-radius:10px;z-index:9999;font-size:18px;';
            loadingMsg.textContent = 'กำลังสร้างไฟล์ SVG... กรุณารอสักครู่';
            document.body.appendChild(loadingMsg);
            
            setTimeout(() => {
                try {
                    // เก็บ SVG ทั้งหมดจากแต่ละ Zone
                    const zones = document.querySelectorAll('.floor-zone');
                    let totalWidth = 0;
                    let totalHeight = 0;
                    const zoneData = [];
                    
                    // คำนวณขนาดรวม
                    zones.forEach((zone, index) => {
                        const drawingRow = zone.querySelector('.drawing-row');
                        const zoneTitle = zone.querySelector('.zone-title');
                        const svgs = drawingRow.querySelectorAll('svg');
                        
                        let rowWidth = 0;
                        let rowHeight = 0;
                        
                        svgs.forEach(svg => {
                            const w = parseInt(svg.getAttribute('width')) || svg.getBoundingClientRect().width;
                            const h = parseInt(svg.getAttribute('height')) || svg.getBoundingClientRect().height;
                            rowWidth += w;
                            rowHeight = Math.max(rowHeight, h);
                        });
                        
                        totalWidth = Math.max(totalWidth, rowWidth);
                        
                        zoneData.push({
                            title: zoneTitle ? zoneTitle.textContent : `Zone ${index + 1}`,
                            svgs: svgs,
                            rowHeight: rowHeight,
                            startY: totalHeight // ไม่มี spacing เพื่อให้ box ติดกัน
                        });
                        
                        totalHeight += rowHeight; // ไม่มี spacing เพื่อให้ box ติดกัน
                    });
                    
                    // สร้าง SVG container
                    const xmlns = 'http://www.w3.org/2000/svg';
                    const combinedSVG = document.createElementNS(xmlns, 'svg');
                    combinedSVG.setAttribute('xmlns', xmlns);
                    combinedSVG.setAttribute('width', totalWidth + 100);
                    combinedSVG.setAttribute('height', totalHeight + 100);
                    combinedSVG.setAttribute('viewBox', `0 0 ${totalWidth + 100} ${totalHeight + 100}`);
                    
                    // เพิ่มพื้นหลังขาว
                    const bg = document.createElementNS(xmlns, 'rect');
                    bg.setAttribute('width', '100%');
                    bg.setAttribute('height', '100%');
                    bg.setAttribute('fill', 'white');
                    combinedSVG.appendChild(bg);
                    
                    // วาดแต่ละ Zone
                    zoneData.forEach((zone, zoneIndex) => {
                        
                        // เพิ่ม SVG แต่ละอัน
                        let currentX = 0;
                        zone.svgs.forEach(svg => {
                            const w = parseInt(svg.getAttribute('width')) || 500;
                            const h = parseInt(svg.getAttribute('height')) || 500;
                            
                            // สร้าง group และ translate
                            const g = document.createElementNS(xmlns, 'g');
                            g.setAttribute('transform', `translate(${currentX}, ${zone.startY})`);
                            
                            // วาดเส้นกรอบ (Border) ของแต่ละ Box
                            const borderRect = document.createElementNS(xmlns, 'rect');
                            borderRect.setAttribute('x', '0');
                            borderRect.setAttribute('y', '0');
                            borderRect.setAttribute('width', w);
                            borderRect.setAttribute('height', h);
                            borderRect.setAttribute('fill', 'white');
                            borderRect.setAttribute('stroke', 'black');
                            borderRect.setAttribute('stroke-width', '1');
                            g.appendChild(borderRect);
                            
                            // Clone inner content ของ SVG
                            Array.from(svg.childNodes).forEach(child => {
                                g.appendChild(child.cloneNode(true));
                            });
                            
                            combinedSVG.appendChild(g);
                            currentX += w;
                        });
                    });
                    
                    // แปลง SVG เป็น string
                    const serializer = new XMLSerializer();
                    let svgString = serializer.serializeToString(combinedSVG);
                    
                    // เพิ่ม XML declaration
                    svgString = '<?xml version="1.0" encoding="UTF-8"?>\n' + svgString;
                    
                    // สร้าง Blob และ Download
                    const blob = new Blob([svgString], { type: 'image/svg+xml' });
                    const url = URL.createObjectURL(blob);
                    
                    const today = new Date();
                    const dateStr = today.toISOString().slice(0, 10);
                    const filename = `Column_Schedule_Elevation_${dateStr}.svg`;
                    
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    // ลบ loading message
                    document.getElementById('loadingMsg').remove();
                    
                    alert(`ส่งออกไฟล์ ${filename} สำเร็จ!\nขนาด: ${(blob.size / 1024 / 1024).toFixed(2)} MB`);
                    
                } catch (error) {
                    document.getElementById('loadingMsg').remove();
                    alert('เกิดข้อผิดพลาด: ' + error.message);
                    console.error(error);
                }
            }, 100);
        }
        
        // Event Listener สำหรับปุ่ม Export SVG
        document.getElementById('exportSVG').addEventListener('click', exportToSVG);

    </script>
</body>
</html>
